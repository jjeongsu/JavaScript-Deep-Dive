# 스코프

모든 식별자(변수, 함수, 클래스의 이름들)은 **선언된 위치**에 따라 다른 코드가 자신을 참조할 수 있는 범위(스코프)가 결정된다.

- 스코프는 식별자가 유효한 범위이다.
- 코드가 어디서 실행되며 주변에는 어떤 코드가 있는지를 `렉시컬환경`이라 한다.
- 코드의 context는 렉시컬 환경으로 이루어지며,이것을 구현한것을 `실행 컨텍스트`라고 한다.

- var`로 선언된 변수는 같은 스코프내에서 재선언이 가능하다
- `let`,`const`로 선언된 변수는 같은 스코프 내에서 재선언이 불가능하다.

- 지역변수는 자신이 있는 지연스코프와 하위지역스코프에서만 유효하다.

## 스코프 체인

- JS 엔진은 스코프체인을 통해 변수를 참조하는 코드의 스코프에서 시작 -> 상위 스코프 방향으로 이동하며 선언된 변수를 검색한다.
- 스코프 체인은 실행컨텍스트의 렉시컬환경을 단방향으로 연결한것.
- **전역렉시컬환경**은 코드가 로드되면 곧바로 생성되고, **함수의 렉시컬환경**은 함수가 **호출**되면 곧바로 생성된다.
- 스코프 체인에서 함수를 검색하는 것 또한 스코프체인을 따라 변수를 검색하는 것과 동일하게 작동한다.
- 가장 상위는 전역스코프이며 전역 스코프부터 힘수, 중첩함수순으로 체이닝되어 있다.
- 전역 변수는 최상위이기에 검색시 가장 늦게 확인하므로 검색속도가 느리다.👉 변수를 사용하는 곳에서 선언하자!
- 호이스팅은 스코프단위로 동작한다.

## 함수 레벨의 스코프

- `var`로 선언된 변수는 함수코드블록 만을 지역스코프로 인정한다.

```javascript
var x = 1
if (true) {
  var x = 10
}
console.log(x) //10
```

- 함수 밖에서 선언된 var변수는 코드블록내에 있더라도 모두 전역변수이다.
- 👉 이렇게 의도치 않게 값이 변경되는 부작용을 일으키므로 사용을 지양하자

## 렉시컬스코프

```javascript
var x = 1

function foo() {
  var x = 10
  bar()
}
function bar() {
  console.log(x)
}

foo() //1
bar() //1
```

- bar함수가 정의된 위치에 따라서 상위스코프가 결정된다. -> 상위스코프에 따라서 결과값이 결정된다.
- `동적 스코프` : 함수를 어디서 `호출`했는지에 따라 상위 스코프가 결정된다.
- `렉시컬/정적 스코프` : 함수를 어디에 `정의`했는지에 따라 상위 스코프 결정
  대부분의 언어는 렉시컬 스코프를 지원하며 js또한 마찬가지이다.
